/*!build time : 2013-11-28 2:26:22 PM*/
KISSY.add("gallery/wordcount/0.1/index",function(a,b,c){function d(){this.init.apply(this,arguments)}var e={type:"han",trim:!1,maxSize:30},f={input:null,output:null,sizeAttr:"size",refresh:!1},g={countdown:'\u8fd8\u80fd\u8f93\u5165<span class="count-hold"><em class="countdown">{over}</em></span>\u5b57',countover:'\u5df2\u7ecf\u8d85\u51fa<span class="count-hold"><em  class="countover">{over}</em></span>\u5b57'};return a.augment(d,{init:function(b){this.cfg=a.merge(e,b)},bind:function(d,e){d=a.merge(f,d),e=a.merge(g,e);var h=this,i=d.sizeAttr,j=b.get(d.input),k=b.get(d.output),l=this.cfg,m=l.maxSize,n=d.type||l.type,o=!!b.attr(j,i)&&d.refresh,p=e.countdown,q=e.countover;return j&&k?(c.on(j,"valuechange",function(){o&&(m=b.attr(j,i));var c=b.val(j),d=h.count(c,{type:n,maxSize:m}),e=d.isOver,f=p;e&&(f=q),b.html(k,a.substitute(f,d))}),l.trim&&c.on(j,"blur",function(){var c=b.val(j);b.val(j,a.trim(c))}),c.fire(j,"valuechange"),{refresh:function(){c.fire(j,"valuechange")}}):void 0},hanCount:function(b){return this.cfg.trim&&(b=a.trim(b)),Math.ceil(this.byteCount(b)/2)},byteCount:function(b){return this.cfg.trim&&(b=a.trim(b)),b.replace(/[^\x00-\xff]/g,"**").length},count:function(b,c){var d=this.cfg,e=(c||d).type,f=(c||d).maxSize;d.trim&&(b=a.trim(b));var g=b.length;switch(e){case"han":g=this.hanCount(b);break;case"byte":g=this.byteCount(b)}var h=f-g;return{count:g,isOver:0>h,over:Math.abs(h)}}}),d},{requires:["dom","event"]});