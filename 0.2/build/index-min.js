/*!build time : 2014-03-31 8:56:10 PM*/
KISSY.add("gallery/wordcount/0.2/index",function(a,b){function c(){this.init.apply(this,arguments)}var d=b.all,e=a.config("mini")?"change":"valuechange",f={type:"han",trim:!1,maxSize:30},g={input:null,output:null,sizeAttr:"size",refresh:!1},h={countdown:'\u8fd8\u80fd\u8f93\u5165<span class="count-hold"><em class="countdown">{over}</em></span>\u5b57',countover:'\u5df2\u7ecf\u8d85\u51fa<span class="count-hold"><em  class="countover">{over}</em></span>\u5b57'};return a.augment(c,{init:function(b){this.cfg=a.merge(f,b)},bind:function(b,c){b=a.merge(g,b),c=a.merge(h,c);var f=this,i=b.sizeAttr,j=d(b.input),k=d(b.output),l=this.cfg,m=l.maxSize,n=b.type||l.type,o=!!j.attr(i)&&b.refresh,p=c.countdown,q=c.countover;return j[0]&&k[0]?(j.on(e,function(){o&&(m=j.attr(i));var b=j.val(),c=f.count(b,{type:n,maxSize:m}),d=c.isOver,e=p;d&&(e=q),k.html(a.substitute(e,c))}),l.trim&&j.on("blur",function(){var b=j.val();j.val(a.trim(b))}),j.fire(e),{refresh:function(){j.fire(e)}}):void 0},hanCount:function(b){return this.cfg.trim&&(b=a.trim(b)),Math.ceil(this.byteCount(b)/2)},byteCount:function(b){return this.cfg.trim&&(b=a.trim(b)),b.replace(/[^\x00-\xff]/g,"**").length},count:function(b,c){var d=this.cfg,e=(c||d).type,f=(c||d).maxSize;d.trim&&(b=a.trim(b));var g=b.length;switch(e){case"han":g=this.hanCount(b);break;case"byte":g=this.byteCount(b)}var h=f-g;return{count:g,isOver:0>h,over:Math.abs(h)}}}),c},{requires:["node"]});